var TechRadar;(function(n){(function(t){var i=function(){function i(n,t,i,r){this.diameter=n,this.quadrant=t,this.goodnessEditable=i;var u=1.1;this.createSvg(r,u),this.drawBackground(u),this.setupForceLayout()}return i.radius=200,i.quadrantGravity=.03,i.prototype.addThings=function(n){var t=this;n.forEach(function(n){return t.things.push(n)}),this.restart()},i.prototype.addOpinion=function(n){this.things.push(n),this.restart()},i.prototype.removeOpinion=function(n){var t=this.things.indexOf(n);console.log("removing opinion from radar ; "+n.name+n.goodness+n.quadrant+n),console.log("index : "+t+"  length (before remove) = "+this.things.length),this.things.splice(t,1),this.restart()},i.prototype.createSvg=function(n,t){var e=d3.select("body").append("svg").attr("class","radar "+n).attr("width",this.diameter*(this.quadrant?1.5:2)).attr("height",this.diameter*(this.quadrant?t:t*2-1));if(this.quadrant)var r=this.diameter/i.radius,u=this.quadrant.isLeft()?i.radius*1.5:0,f=this.quadrant.isTop()?i.radius*t:0;else var r=this.diameter/(i.radius*2),u=i.radius*2,f=i.radius*t;this.svg=e.append("g").attr("transform","scale("+r+") translate("+u+", "+f+")")},i.prototype.drawBackground=function(n){this.drawLabeledCircle("Doen!",.47,i.radius*.4),this.drawLabeledCircle("Proberen",.4,i.radius*.7),this.drawCenteredCircle(i.radius*.85),this.drawLabeledCircle("Experimenteren",.53,i.radius*.86),this.drawLabeledCircle("Afblijven",.27,i.radius*1);var t=i.radius*n;this.drawLine(0,t,0,-t),this.drawLine(t,0,-t,0)},i.prototype.setupForceLayout=function(){var n=this;this.force=d3.layout.force().nodes([]).size([i.radius*2,i.radius*2]).gravity(0).charge(-50).on("tick",function(t){return n.tick(t)}),this.things=this.force.nodes()},i.prototype.restart=function(){var n=this.svg.selectAll("circle.thing").data(this.things),t=this.svg.selectAll("text.thing").data(this.things);n.exit().remove(),t.exit().remove(),n.enter().append("circle").attr("class","thing").attr("r",4).call(this.force.drag),t.enter().append("text").attr("class","thing").attr("dx",function(n){return(n.quadrant.isLeft()?-1:1)*12}).attr("dy",4).attr("text-anchor",function(n){return n.quadrant.isLeft()?"end":"start"}).text(function(n){return n.name}),this.force.start(),console.log("end of restart, things on radar : "),this.things.forEach(function(n){return console.log(", "+n.name)})},i.prototype.tick=function(t){var r=this,u;this.things.forEach(function(u){u.updatePolar(),u.fixRadius(r.goodnessEditable),u.polar.phi+=(u.quadrant.angle-u.polar.phi)*t.alpha*i.quadrantGravity;var f=10/(u.polar.r+.1);u.polar.phi=n.cap(u.quadrant.angleLower()+f,u.polar.phi,u.quadrant.angleUpper()-f),u.polar.r=Math.min(u.polar.r,i.radius),u.updateXY()}),u=this.diameter/2,this.svg.selectAll("circle.thing").attr("cx",function(n){return n.x}).attr("cy",function(n){return n.y}),this.svg.selectAll("text.thing").attr("x",function(n){return n.x}).attr("y",function(n){return n.y})},i.prototype.drawLine=function(n,t,i,r){this.svg.append("line").attr("class","lines").attr("x1",n).attr("y1",t).attr("x2",i).attr("y2",r)},i.prototype.drawLabeledCircle=function(n,r,u){var s=this.quadrant||t.Quadrant.Tools,f,e,o,c,l,h;this.drawCenteredCircle(u),s.isTop()?f=0:(f=Math.PI,r=-r),s.isLeft()?(e=f-r,o=f):(e=f,o=f+r),s.isTop()||(c=o,o=e,e=c),l=d3.svg.arc().innerRadius(u-.02*i.radius).outerRadius(u+.02*i.radius).startAngle(e).endAngle(o),h=n.replace(/[^a-z]/,""),this.svg.append("path").attr("d",l).attr("id",h).style("stroke","none").style("fill","white"),this.svg.append("text").append("textPath").attr("xlink:href","#"+h).attr("startOffset",s.isTop()?"0%":"50%").append("tspan").attr("dy",8).attr("dx",5).text(n)},i.prototype.drawCenteredCircle=function(n){this.svg.append("circle").attr("class","lines").attr("cx",0).attr("cy",0).attr("r",n)},i}();t.Radar=i})(n.Client||(n.Client={}));var t=n.Client})(TechRadar||(TechRadar={}))